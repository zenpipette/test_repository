{
  "hash": "13035810bd5cb7c504499ae127312179",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"BCB 520 Assignment\"\nauthor: \"Sharon\"\nformat: html\n---\n\n\n# My Dataset\n\nHerein lies a BCB 520 assignment, where I describe some lovely fecal microbiome data.\n\nI have chosen an infant fecal microbiome relative abundance dataset. This data contains the top 30 most abundant bacterial genera, from 21 infants, averaged over 9 collection timepoints. The read counts are expressed as a percentage of the total read counts (relative abundance). The name of this file is IF_top30.rds.\n\nI have also included Infant_Fecal_Relabund.rds which is the less processed version of IF_top30.rds. It has not been averaged across timpepoint, or selected for the top 30. \n\n# Background\n\nThe samples represented here are a subset of samples from a larger study, where milk, maternal oral, maternal fecal, infant oral, and infant fecal samples were collected and sequenced. The microbiomes were characterized by sequencing the V1-V3 regions of the 16S ribosomal RNA gene.\n\nDietary data was also collected, and milk fatty acids were qualitatively assessed using GC-FID.\n\nAt least 3 papers have been published by the McGuire/Williams laboratory on this dataset, nicknamed \"The Gates data\" because it was funded by the Bill and Melinda Gates Foundation.\n\nThe infant fecal microbiome is already publicly available on the Sequence Read Archive (SRA) so it has been selected for this assignment.\n\n\n\n\n\n# Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(Hmisc)\nlibrary(corrplot)\n```\n:::\n\n\n# Import and view .rds files\n\n## A smaller dataset\n\nThis is a simple 21 row by 30 row data table. The participants (A003, A005...) are the row names. Each column contains the relative abundance (%) of each of the top 30 bacterial genera. Note that each value is actually the average of up to 9 timepoints, so each value represents the average relative abundance of the genera between day 2 and 6 month after birth.\n\nLoad the data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIF_top30 <- readRDS(\"C:/Users/sharo/Desktop/BCB 520/Assignments/IF_top30.rds\")\n```\n:::\n\n\nView a subset of the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIF_top30[,1:4]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Bacteroides Escherichia.Shigella Veillonella Clostridium.sensu.stricto\nA003  0.23493134         24.673454640   6.6693137               8.296923750\nA005  4.02761085         20.209190530  11.1726579               6.019777140\nA007  0.19334102          4.074305556  24.9752758               0.659688178\nA009  0.02770472         57.396699533   0.1416980              11.107959633\nA011  9.26831811          4.852269800  18.2515791               0.052937900\nA013  0.25171539         14.938690870  25.1883604               2.902620620\nA015 40.65170057         13.094583838   2.0534671               0.152828987\nA017 29.87910938          4.391378011   5.1910630               0.307567033\nA019 44.56634097          7.588655580   5.0236797               0.106448550\nA021 40.75502674          1.106360367   4.9050189               3.952965600\nA025 34.51478583          1.733203256   3.5605401               0.000000000\nA027  1.02156002          6.573109900  28.7444037              24.638294267\nA029 44.22892401         23.098446878   2.1665187               0.090762833\nA031  0.05744295         62.947694350   3.3153721              26.952580000\nA033 38.51864961         12.478839610   6.6155465               7.548103950\nA035 34.68255444          6.776953956   1.5039755              32.013236233\nA037 14.03453994         18.774367287  10.5120452              24.897731312\nA039  0.11653624         47.718616850  17.9059235               2.086916700\nA041 21.72538480          9.548148850   0.5365920              10.075460910\nA043  8.18592391          0.006921912   4.7780929              17.086879375\nA045 64.73004397          8.060339722   0.2979979               0.002079567\n```\n\n\n:::\n:::\n\n\n## A larger dataset\n\nJust for fun, here is a more \"uncut\" version of the same data table. Note that there are 186 rows because there is a data point for each time point for each participant, and there are 406 columns of data representing bacterial genera with non-zero reads.\n\n(Note that this table has also been processed to exclude non-zero reads).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nInfant_Fecal_Relabund <- readRDS(\"C:/Users/sharo/Desktop/BCB 520/Assignments/Infant_Fecal_Relabund.rds\")\n```\n:::\n\n\nData set dimensions\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(Infant_Fecal_Relabund)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 186 406\n```\n\n\n:::\n:::\n\n\nView a subset of the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nInfant_Fecal_Relabund[1:30,1:4]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         Unclassified Abiotrophia Acetanaerobacterium Acetivibrio\nA003_180     9.749444           0           0.0000000           0\nA003_2      10.076098           0           0.0091700           0\nA003_10      5.317788           0           0.0000000           0\nA003_120     1.054935           0           0.0000000           0\nA003_150     3.518440           0           0.0000000           0\nA003_30      3.289348           0           0.0000000           0\nA003_5       3.287554           0           0.0000000           0\nA003_60      6.110080           0           0.0000000           0\nA003_90      2.089608           0           0.0000000           0\nA003_Mec     4.497608           0           0.0000000           0\nA005_10      3.211669           0           0.0000000           0\nA005_120     1.230697           0           0.0000000           0\nA005_150     7.330550           0           0.0000000           0\nA005_180     2.949062           0           0.0000000           0\nA005_2       2.898207           0           0.0000000           0\nA005_30      8.671352           0           0.0000000           0\nA005_5       3.936611           0           0.0000000           0\nA005_60      7.455959           0           0.0000000           0\nA005_90      3.532036           0           0.0000000           0\nA005_Mec     6.088191           0           0.0083500           0\nA007_10      2.055499           0           0.0000000           0\nA007_120     9.346856           0           0.0000000           0\nA007_150    13.934606           0           0.0000000           0\nA007_180     8.489646           0           0.0000000           0\nA007_2       4.497867           0           0.0775494           0\nA007_30     10.863575           0           0.0000000           0\nA007_5       4.407339           0           0.0000000           0\nA007_60      4.272310           0           0.0000000           0\nA007_90      7.544436           0           0.0000000           0\nA009_10      6.217265           0           0.0000000           0\n```\n\n\n:::\n:::\n\n\n# Describe the data\n\nThis is tabular data. While I only have one dimension here, it could be considered multi-dimensional since I have several other datasets for these mother-infant dyads.\n\nI have one category here- infant fecal. Other categories I have are infant oral, maternal fecal, maternal oral, and milk.\n\nThere is a time component, which could be considered ordered or sequential.\n\nThe unique key is the row name, which is participant in the smaller data set and a participant_time combo in the larger data set. In the largest data sets of all, we have a sampletype_participant_timepoint combo.\n\nThe columns (attributes) are read count relative abundance expressed as a percentage of the total read counts per row. These are the quantitative data type.\n\n\n# Correlations\n\nThe genera read counts are non-parametric, therefore the spearman-rank correlation was used to assess possible correlations between each set of read counts.\n\n## Create correlation matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIF_IF_rcorr <- rcorr(as.matrix(IF_top30), type=c(\"spearman\"))\n```\n:::\n\n\n## Correlation plot 1 - square matrix, no p values, 30x30\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(IF_IF_rcorr$r, method=c(\"circle\"), tl.cex=0.5, order=\"AOE\")\nmtext(\"Infant Fecal Microbiome Correlation with AOE Cluster (6 mo avg)\", line =3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## Correlation plot 2 - lower triangle only, with p values starred, 30x30\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(IF_IF_rcorr$r, p.mat=IF_IF_rcorr$P, sig.level=c(0.01,0.05, 0.1), \n         insig='label_sig', pch.col='black', pch.cex=0.7,\n         method=c(\"circle\"), tl.cex=0.5, order=\"AOE\", type=\"lower\", diag = F)\nmtext(\"Infant Fecal Microbiome Correlation with AOE Cluster (6 mo avg)\", line =3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## Correlation plot 3 - lower triangle only, with p values starred, 20x20\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(IF_IF_rcorr$r[1:20,1:20], p.mat=IF_IF_rcorr$P[1:20, 1:20], sig.level=c(0.01,0.05, 0.1), \n         insig='label_sig', pch.col='black', pch.cex=0.9,\n         method=c(\"circle\"), tl.cex=0.5, order=\"AOE\", type=\"lower\", diag = F)\nmtext(\"Infant Fecal Microbiome Correlation with AOE Cluster (6 mo avg)\", line =3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}